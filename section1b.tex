%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  New template code for TAMU Theses and Dissertations starting Fall 2012.  
%  For more info about this template or the 
%  TAMU LaTeX User's Group, see http://www.howdy.me/.
%
%  Author: Wendy Lynn Turner 
%	 Version 1.0 
%  Last updated 8/5/2012
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                           SECTION I
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\chapter{\uppercase {Hyperbolic scalar and system of equations:}}
%
In this chapter, some key properties of the hyperbolic system of equations are recalled. The objective is to introduce the reader to the notion of shock, weak solution and entropy minimum principle by studying a simple hyperbolic scalar equation through a linear progression. First, the mathematical properties of the hyperbolic scalar equation are studied and include the derivation of the eigenvalue and the characteristic equation. Then, it is explained how shock are formed which will bring us to show that the solution is non-unique. The reader will be introduced to the notion of weak solution. Lastly, it will be explained how the entropy condition is used to ensure uniqueness of the solution and more importantly, ensure convergence of the numerical solution to the physical one. In the last section of this chapter, the notions introduced for the hyperbolic scalar equation are generalized to systems of equation.
%=============================
\section{Hyperbolic scalar equations:}
%=============================
The study of a hyperbolic scalar equation is detailed in order to provide the reader with a better understanding of its mathematical properties that are useful to the comprehension of shock formation among others.
%%%%%%%%%%%%%%%%%%%%
\subsection{Eigenvalue and characteristic curves:}\label{sec:mat_ppr}
%%%%%%%%%%%%%%%%%%%%
For academic purpose, we consider a simple hyperbolic scalar equation with initial conditions to form what is called an \emph{Initial Boundary Value Problem} (IBVP) as shown in \eqt{eq:ivp_sct1b}. We define a computational domain $\Omega$ of dimension $d$, bounded by the boundary $\Gamma$ of dimension $d-1$. Each variable is assumed to be a function of space, $\vec{r} \in R^d$, and time, $t \in R_+$.
%
\begin{equation}\label{eq:ivp_sct1b}
\left\{
\begin{array}{l}
\partial_t u(\vec{r},t) + \div ( f(u) \vec{n} ) = 0 \text{, } \left( \vec{r}, t \right) \in R^d \times R_+  \nonumber \\
u(\vec{r},0) = u( \vec{r}_0) 
\end{array}
\right.
\end{equation}
%
where $u$ and $f(u)$ are the solution and the inviscid flux, respectively. The inviscid flux $f(u)$ is assumed to be a differential function of the solution $u$. Two definitions of the inviscid flux will be considered in this chapter in order to illustrate the differences between linear and non-linear hyperbolic scalar systems: a linear flux $\vec{f}_1$ and a non-linear flux $\vec{f}_2$, as follows:
%
\begin{subequations}\label{eq:ivp2_sct1b}
%
\begin{equation}\label{eq:trans_sct1b}
\partial_t u(\vec{r},t) + \div \vec{f}_1(u) = \partial_t u(\vec{r},t) + \div \left( au \right) = 0
\end{equation}
%
\begin{equation}\label{eq:burger_sct1b}
\partial_t u(\vec{r},t) + \div \vec{f}_2(u) = \partial_t u(\vec{r},t) + \div \left( \frac{u^2}{2} \right) = 0
\end{equation}
%
\end{subequations}
%
\eqt{eq:trans_sct1b} and \eqt{eq:burger_sct1b} are respectively known as the transport and Burger's equations. They have been widely studied in the literature and are well understood (REFS). 

The eigenvalue, $\lambda$, of the hyperbolic equation is obtained by looking at the derivative of the inviscid flux, $f(u)$, with respect to the solution $u$, and corresponds to the wave propagation speed. When considering the fluxes $f_1$ and $f_2$, it is found that their eigenvalues are $\lambda_1 = a$ and $\lambda_2 = u$, respectively. For the linear advection equation, the wave speed is a constant through the computational domain. On the other hand, the wave speed is a function of space and time since equal to the solution itself, for the Burger's equation.

Once the eigenvalues are determined, the next step consists of deriving the characteristic equation and the characteristic curves. For implicitly purpose, we limit ourself to the $x-t$ plane. Under this assumption, characteristic curves are defined as curves $x = x(t)$ in the plane $x-t$ along with the PDE becomes an ODE \cite{Toro}. To determine the characteristic curves, \eqt{eq:ivp_sct1b} is recast as a function of the eigenvalue, $\lambda$, by using the chain rule as shown in 
%
\begin{eqnarray}\label{eq:ivp3_sct1b}
&&\partial_t u(\vec{r},t) + \frac{df}{du}\partial_x u = 0 \nonumber\\
&&\partial_t u(\vec{r},t) + \lambda \partial_x u = 0 \nonumber \\
&&\partial_t u(\vec{r},t) + \frac{dx}{dt} \partial_x u = 0 \text{ along } \frac{dx}{dt} = f'(u) = \lambda 
\end{eqnarray}
%
\eqt{eq:ivp3_sct1b} represents the rate of change of the solution $u$ along the curve $\frac{dx}{dt} = f'(u) = \lambda$. As a results, it tells us that the solution $u$ is constant along the curve $\frac{dx}{dt} = \lambda$ since its rate of change is zero. The eigenvalue is the slope of characteristic curve and is referred to as the characteristic speed. 
%For the linear advection equation, the characteristic speed is constant and equal to $a$, whereas it is a function of space and time for Burger's equation since equal to the solution itself. 
For a given characteristic curve, the characteristic speed is a constant, since the solution $u$ is constant as well, and given by the initial condition, $f'(u)=f'(u_0)$ which allows us to integrate in order to obtain an analytical expression:
%
\begin{eqnarray}\label{eq:ivp4_sct1b}
\frac{dx}{dt} &=& a \nonumber \\
\Leftrightarrow x(t) &=& x_0 + f'(u_0)t
\end{eqnarray}
%
where we set $x(t=0) = x_0$ that can be seen as the initial position of a particle traveling along the characteristic curve. It is current to represent the characteristic curves in a $t-x$ plane and example will be given for the linear advection and Burger's equation. \eqt{eq:ivp4_sct1b} informs us on the position $x$ of a particle of initial solution $u_0$ for each time $t$. Now, assuming that the initial value of the solution is $u_0(x_0)$ along the characteristic curve given by \eqt{eq:ivp4_sct1b} and passing through the point $x_0$, the solution $u(x,t)$ at position $x$ and time $t$ can be expressed as follows:
%
\begin{equation}\label{eq:ivp5_sct1b}
u(x,t) = u_0(x_0) = u_0(x - f'(u_0)t)
\end{equation}
%
\label{eq:ivp5_sct1b} can be seen as an analytical solution of the hyperbolic scalar equation (\eqt{eq:ivp_sct1b}). It is also understood that the derivative of the flux that corresponds to the eigenvalue of the system, has profound consequence on the behavior of the solution as explained in \sect{sec:shock_form}. 
%%%%%%%%%%%%%%%%%%%%
\subsection{Formation of shocks}\label{sec:shock_form}
%%%%%%%%%%%%%%%%%%%%
Hyperbolic scalar equations are known to develop shocks even from a smooth initial profile. This section aims at detailing how shocks form based on the mathematical properties introduced in \sect{sec:mat_ppr} and the two examples of \eqt{eq:trans_sct1b} and \eqt{eq:burger_sct1b}, i.e., the $1$-D linear advection and Burger's equations.\\

When considering the linear advection equation recalled in \eqt{eq:trans_sct1b} with the flux $f_1(u) = au$, the eigenvalue is found equal to $\lambda_1=a$ and constant. Thus, the slope of the characteristic curve remains constant and each particle travels at the same velocity through the computational domain. In other word, the initial profile of the solution is simply translated at speed $a$ to the right if $a \geq 0$ and to the left if $a \leq 0$. Obviously, if $a=0$, the flux is also null and the solution remains static. A representation of the characteristic curve for the linear advection equation, \eqt{eq:trans_sct1b}, is given in (FIGURE) in a $t-x$ plane: all of the characteristic curves are parallel since the eigenvalue is constant.

In the case of Burger's equation, the eigenvalue is, once again, obtained by computing the derivative of the flux $f_2(u) = u^2/2$, to obtain $\lambda_2 = u$. The slope of the characteristic curves is a function of the initial profile of the solution which requires the study of two distinct cases: a constant initial solution and a non-constant initial solution. In the former case, the slope of the characteristic is constant which is the identical case to the linear advection equation. In the later case, the characteristic curve will not have the same slope and may intersect. When two characteristic curves intersect, it means that at a given time and position, two values of the solution are allowed (each characteristic curve carries a different initial values of the solution): the solution displays an infinite gradient also called shock wave and can eventually leads to breaking wave type solution as shown in FIGURE. The time the shock occurs at can be analytically determined. Let consider a non-linear flux $f(u)$ and two characteristic curves originating from the position $x_0$ and $x_0+dx$ and carrying the initial values $u_0(x_0)$ and $u_0(x_0+dx)$, respectively. The characteristic curves are:
%
\begin{eqnarray}\label{eq:cc1_sct1b}
&&x_1 = x_0 + f'(u_0(x_0)) t \nonumber \\ 
&&x_2 = (x_0 + dx) + f'(u_0(x_0+dx)) t \nonumber 
\end{eqnarray}
%
Let now assume that the characteristic curves intersect at time $\tau_{shock}$, which implies $x_1 = x_2$. $\tau_{shock}$ is often referred to as the breaking time. Using \eqt{eq:cc1_sct1b}, an expression for $\tau_{shock}$ can be derived as follows: 
\begin{equation}
\tau_{shock} = \frac{-dx}{f'(u_0(x_0+dx))-f'(u_0(x_0))}
\end{equation} 
Taking the limit $dx \lim 0$ and using the definition of derivative, the above expression yields:
\begin{equation}\label{eq:cc2_sct1b}
\tau_{shock} = \frac{-1}{f''(u_0) u'_0} = \frac{-1}{f'(u_0)},
\end{equation} 
The trivial case $f''(u) = 0$ is ruled out since it was assumed a non-linear flux. However, let assume that the flux is linear. In that case, the second-order derivative is null and by taking the limit of \eqt{eq:cc2_sct1b}, it yields $\tau_{shock} \to \infty$ which means that a shock wave never forms. This result is consistent with conclusion made earlier in this section when studying the linear advection equation (\eqt{eq:trans_sct1b}). Going back to a non-linear flux, breaking first occurs where the derivative of the flux is negative and its absolute value is maximum.   \\
Knowing the breaking time $\tau_{shock}$ and position is not sufficient information to track a shock wave once it is formed. An useful information will be to derive an expression that provides us with the speed of the shock. One of the reason for deriving such expression is, to obtain an analytical solution that can be used for comparison against numerical solutions in order to assess their accuracy. To do so, we consider, one again, a general $1$-D hyperbolic scalar equation for simplicity as shown in 
%
\begin{equation}\label{eq:rh_sct1b}
\partial_t u(x,t) + \partial_x f(u(x,t)) = 0
\end{equation}
%
We assume that the position of the shock is given by a function of time denoted by $s(t)$ and that the associated speed is $S = \frac{ds}{dt}$. At this particular position, the derivatives of the solution $u$ and the flux $f(u)$ are not continuous. We also define a control volume $\left[ x_1; x_2 \right]$ that contains the shock wave so that $x_1 \leq s(t) \leq x_2$. \eqt{eq:rh_sct1b} is integrated over the control volume as shown in \eqt{eq:rh2_sct1b}:
%
\begin{equation}\label{eq:rh2_sct1b}
\frac{d}{dt} \int_{x_1}^{s(t)} u(x,t) dx + \frac{d}{dt} \int_{s(t)}^{x_2} u(x,t) dx + f(x_2,t) - f(x_1,t) = 0
\end{equation}
% 
The first two integrals can be recast by using the following chain rule:
%
\begin{equation}\label{eq:rh3_sct1b}
\frac{d}{dt} \int_{y_1(t)}^{y_2(t)} g(y,t) dy =  \int_{y_1(t)}^{y_2(t)} g(y,t) dy + g(y_2,t) \frac{d y_2(t)}{dt} - g(y_1,t) \frac{d y_1(t)}{dt},
\end{equation}
% 
which yields by noticing that $x_1$ and $x_2$ are not a function of time:
%
\begin{equation}\label{eq:rh4_sct1b}
\int_{x_1}^{s(t)} \partial_t u(x,t) dx - \int_{s(t)}^{x_2} \partial_t u(x,t) dx + \left( u(s^-(t)) - u(s^+(t)) \right) S + f(x_2,t) - f(x_1,t) = 0
\end{equation}
%
where $u(s^-(t),t)$ and $u(s^+(t),t)$ are the values of the solution $u$ before and after the shock, respectively. We now assume that the $x_1$ and $x_2$ approach the shock position $s(t)$ from the left and right, respectively, and that $\partial_t u$ is bounded, the integrals vanish to yield the following expression for the speed of shock $S$:
%
\begin{equation}\label{eq:rh5_sct1b}
S = \frac{f(x_2,t) - f(x_1,t)}{u(s^-(t)) - u(s^+(t))} = \frac{\Delta f}{\Delta u}
\end{equation}
%
The above expression computing the speed of shock (\eqt{eq:rh5_sct1b}) is known as the Rankine-Hugoniot jump condition. The hyperbolic scalar equation given \eqt{eq:rh_sct1b} is only valid in smooth parts of the solution, and thus, require the use of the Rankine-Hugoniot jump condition in order to solve for the shock region.   
%its speed can be determined by the Rankine-Hugoniot condition
%However, along the characteristic curves, the solution remains constant which allows us to integrate to obtain an analytical expression for the characteristic curve. For the purpose of plotting the characteristic curves, we assume a computational domain of length one and that the initial condition for the solution is of the form $u(x_0) = \sin (\pi x)$. With such initial condition, the slope of the characteristic curve is no longer constant but vary both in time and space. As a result, some of the characteristic curves will intersect  
\begin{itemize}
\item hyperbolic scalar equations are known to produce shocks even with smooth initial conditions.
\item explain how shocks can form with characteristic equations.
\item talk about diffusion equation that does not produce shocks -> same equation but with diffusion term that smoothes out shocks. Solution is unique and smooth.
\item idea is to add diffusion to the hyperbolic equation in order to control the shock.
\end{itemize}
%
\subsection{Weak solution:}
introduce the notion of weak solution and non-uniqueness of the weak solution.
%
\subsection{Entropy minimum principle:}
Condition for uniqueness of the solution. Show an example of the derivation for Burger's equations.
%
\section{Hyperbolic system of equations:}
%
\begin{itemize}
\item hyperbolic system of equations can also produce shocks.
\item same treatment as scalar equations.
\end{itemize}